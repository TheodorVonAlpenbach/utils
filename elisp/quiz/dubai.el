(setq table '((11  "Eljanov, Pavel"               (80w1  45b½  40w1  49b1  53w1   1b½   6w1   2w½)    2   6.5)
( 1  "Nisipeanu, Liviu-Dieter"      (70w1  35b1  20w1  28w1   2b½  11w½   3b½  14b½)    0   6.0)
( 2  "Sasikiran, Krishnan"          (71b1  37w1  23b½  29w1   1w½  17b1  14w½  11b½)    0   6.0)
( 3  "Mamedyarov, Shakriyar"        (72w1  36b1  24w1  53b½  16w1  14b½   1w½  20b½)    0   6.0)
( 4  "Iordachesvu, Viorel"          (73b1  39w1  28b0  42w½  44b1  58w1  16b1   9w½)    0   6.0)
( 5  "Vladimirov, Evgeny"           (74w1  38b½  34w1  26b0  40w1  24b½  28w1  36b1)    0   6.0)
( 9  "Harikrishna, P."              (78w1  43b1  49w½  32b1  26w½  20b½  22w1)   4b½    0   6.0)
(10  "Miroshnichenko, Evgenij"      (79b1  44w1  33b½  31w0  42b1  39w1  23b½  21w1)    0   6.0)
(14  "Minasian, Artashes"           (83b1  48w½  46b1  33w1  58b1   3w½   2b½   1w½)    0   6.0)
(20  "Goloshchapov, Alexander"      (89b1  56w1   1b0  54w1  38b1   9w½   7b1   3w½)    0   6.0)
(26  "Carlsen, Magnus"              (95b½  77w1  65b1   5w1   9b½   7w½  15w1   6b½)    0   6.0)
( 6  "Fedorov, Alexei"              (75b1  42w1  31b½  23w½  28b1  27w1  11b0  26w½)    0   5.5)
( 7  "Jobava, Baadur"               (76w1  41b1  32w½  45b½  36w1  26b½  20w0  23w1)    2   5.5)
(16  "Al-Modiahki, Mohamad"         (85b1  52w1  62b½  67w1   3b0  31w1   4w0  35b1)    0   5.5)
(17  "Ulibin, Mikhail"              (86w1  49b0  64w1  47b1  43w1   2w0  29b1  24b½)    0   5.5)
(18  "Izoria, Zviad"                (87b1  54w1  67b½  58w0  50b½  48w1  31b½  38w1)    0   5.5)
(22  "Efimenko, Zahar"              (91b1  58w0  73b½  87w1  62b1  67w1   9b0  42w1)    0   5.5)
(24  "Gagunashvili, Merab"          (93b1  61w1   3b0  56w1  39b½   5w½  63b1  17w½)    0   5.5)
(31  "Kruppa, Yuri"                (100w1  66b1   6w½  10b1  15w½  16b0  18w½  53b1)    0   5.5)
(32  "Sturua, Zurab"               (101b1  69w1   7b½   9w0  67b0  81w1  52b1  56w1)    0   5.5)
(33  "Dizdar, Goran"               (102w1 137b1  10w½  14b0  66w½  71b½  57w1  15b1)    0   5.5)
(39  "Mamedov, Rauf"               (108w1   4b0  85w1  79b1  24w½  10b0  78w1  19w1)    2   5.5)
(51  "Al Sayed, Mohamad N."        (119b½ 103w½  93b1  25w½  29b½  12b½  30w1  27w1)    0   5.5)
(12  "Gleizerov, Evgeny"            (81b1  46w½  48b½  50w½  52b½  51w½  43b½  58w1)    0   5.0)
(21  "Kuzmin, Alexey"               (90w1  55b½  45w0  76b1  49w1  53b½ 108w1  10b0)    0   5.0)
(23  "Gashimov, Vugar"              (92w1  57b1   2w½   6b½  45w1  15b½  10w½   7b0)    0   5.0)
(25  "Ghaem Maghami, Ehsan"         (94w1  59b½  55w½  51b½  64w½  66b½  49w1  47b½)    0   5.0)
(28  "Gelashvili, Tamaz"            (97b1  63w1   4w1   1b0   6w0  64b1   5b0  61w1)    0   5.0)
(29  "Iuldachev, Saidali"           (98w1  64b½  59w1   2b0  51w½  70b1  17w0  62w1)    2   5.0)
(36  "Dzhumaev, Marat"             (105b1   3w0  83b1  61w1   7b0  50w1  13b1   5w0)    0   5.0)
(40  "Ramesh, R.B."                (109b½ 119w1  11b0  77w1   5b0  95w1  58b½  67w1)    0   5.0)
(41  "Lahno, Katerya"              (124b1   7w0  87b0  98w1  89b1  52w½  67b½  93w1)    0   5.0)
(47  "Belkhodja, Slim"             (115b1  13w0  91b1  17w0  87b1  69w1  19b½  25w½)    0   5.0)
(63  "El Arousy, Abdul Hameed"     (132w1  28b0 108w½  94b½ 136w1  45b1  24w0  37w1)    2   5.0)
( 8  "Asrian, Karen"                (77b½  95w1  38b½  44w0  81b½  62w½  96w1  48b½)    0   4.5)
(13  "Anastasian, Ashot"            (82w1  47b1  53w0  43b0  72w1  55b1  36w0  50b½)    0   4.5)
(15  "Ganguly, Suyra Shekhar"         (r1  50w1  58b½  62w1  31b½  23w½  26b0  33w0)    1   4.5)
(19  "Korobov, Anton"               (88w1  53b0  72w1  48b0  79w1  59b1  47w½  39b0)    0   4.5)
(27  "Mchedlishvili, Mikheil"       (96w1  62b0  74w1  55b1  48w1   6b0  53w½  51b0)    0   4.5)
(34  "Miezis, Normunds"            (103b½ 109w1   5b0  73w0 117b1  83w1  56b0  74w1)    0   4.5)
(35  "Vakhidov, Tahir"             (104w1   1w0  81b½  78b1  73w½  80b½  66w1  16w0)    2   4.5)
(38  "Safin, Shukhrat"             (107b1   5w½   8w½  70b1  20w0  96b½  73w1  18b0)    0   4.5)
(42  "Mahjoob, Morteza"            (110w1   6b0  86w1   4b½  10w0  82b1  80w1  22b0)    0   4.5)
(43  "Villamayor, Buenaventura"    (111b1   9w0  89b1  13w1  17b0  56w½  12w½  64b½)    0   4.5)
(44  "Mamedov, Nidjat"             (112w1  10b0  88w1   8b1   4w0 108b0  72w1  71b½)    0   4.5)
(45  "Megaranto, Susanto"          (113b1  11w½  21b1   7w½  23b0  63w0  74b½  75b1)   -2   4.5)
(46  "Hakki, Imad"                 (114w1  12b½  14w0  80b0 104w½ 127w1  76b1 108b½)    0   4.5)
(48  "Sale, Srdjan"                (116w1  14b½  12w½  19w1  27b0  18b0  85w1   8w½)    2   4.5)
(50  "Shanava, Konstantine"        (118w1  15b0  90w1  12b½  18w½  36b0  88w1  13w½)    2   4.5)
(53  "Mariano, Nelson"             (121b1  19w1  13b1   3w½  11b0  21w½  27b½  31w0)    0   4.5)
(54  "Gupta, Abhjeet"              (123w1  18b0  96w1  20b0  82w½  78b0  89w1  86b1)    0   4.5)
(55  "Kosasih, Cecep"              (125b1  21w½  25b½  27w0  93b1  13w0  79b½  81w1)    0   4.5)
(56  "Barnaure, Vlad-Victor"       (126w1  20b0  98w1  24b0  94w1  43b½  34w1  32b0)    0   4.5)
(64  "Shetty, Rahul"               (133b1  29w½  17b0  97w1  25b½  28w0  91b1  43w½)    0   4.5)
(66  "Othman, A. Moussa"           (135b1  31w0 103b1  37w½  33b½  25w½  35b0  90w1)    0   4.5)
(71  "Bouaziz, Slim"                 (2w0 104b½ 135b1 101w½ 105b1  33w½  37b½  44w½)    0   4.5)
(73  "Mamedjarova, Zeinab"           (4w0 106b1  22w½  34b1  35b½  37w½  38b0  30w1)    0   4.5)
(79  "Novita, Anjas"                (10w0 112b1  30w1  39w0  19b0 100b1  55w½  57b1)    0   4.5)
(96  "Chokshi, Manthan J."          (27b0 130w1  54b0 137w1  61b1  38w½   8b0)  69w1    0   4.5)
(04  "Coleman, James"               (35b0  71w½ 119b0 115w1  46b½  87w1  69b½  70w1)    0   4.5)
(08  "Negi, Parimarjan"             (39b0  75w1  63b½  69w½  65b1  44w1  21b0  46w½)    0   4.5)
(19  "Abedi, Ali"                   (51w½  40b0 104w1  30b0  92w1  57b0  82w1  59b1)    0   4.5)
(37  "El Taher, Fouad"             (106w1   2b0  82w1  66b½  80w½  73b½  71w½  63b0)    0   4.0)
(49  "Moradiabadi, Elshan"         (117b1  17w1   9b½  11w0  21b0  97w1  25b0  78w½)    0   4.0)
(52  "Kayumov, Sergey"             (120w1  16b0  94w½  92b1  12w½  41b½  32w0  80b½)    0   4.0)
(58  "Nadera, Barlo A."            (128w1  22b1  15w½  18b1  14w0   4b0  40w½)  12b0    0   4.0)
(61  "Hamdani, Rudin"              (130w1  24b0 100w1  36b0  96w0  98b1  94w1  28b0)    0   4.0)
(62  "Wahono, Awam"                (131b1  27w1  16w½  15b0  22w0   8b½  99w1  29b0)    0   4.0)
(65  "Al-Hadarani, Hatim"          (134w½ 122b1  26w0 136b½ 108w0  99b0 115b1  94w1)    0   4.0)
(67  "Satyapragyan, Swayangsu"     (136w1  30b1  18w½  16b0  32w1  22b0  41w½  40b0)    0   4.0)
(76  "Wopng Zi Jing"                 (7b0 110w½ 109b1  21w0 106b½ 103w1  46w0 100b1)    0   4.0)
(77  "Deepan, Chakkravarthy J."      (8w½  26b0 122w1  40b0 110w1  30b0  92w½ 102b1)    0   4.0)
(78  "Safarli, Eltaj"                (9b0 111w½ 110b1  35w0 107b1  54w1  39b0  49b½)   -2   4.0)
(80  "Tondivar, Babak"              (11b0 113w½ 111b1  46w1  37b½  35w½  42b0  52w½)    0   4.0)
(83  "Velcheva, Maria"              (14w0 116b1  36w0 102b1  30w½  34b0 127w½ 123b1)    0   4.0)
(85  "Asabri, Hussein"              (16w0 118b1  39b0 105w0 121b1 106w1  48b0  99w1)    0   4.0)
(87  "Paridar, Shadi"               (18w0 120b1  41w1  22b0  47w0 104b0 118w1 127b1)    0   4.0)
(88  "Ramaswamy, Aarthie"           (19b0 121w1  44b0 117w0 116b1 105w1  50b0 103w1)    0   4.0)
(93  "Simonsen, Hans Kristian"      (24w0 128b1  51w0 130b1  55w0 118b1  70w1  41b0)    0   4.0)
(21  "Navabi, Shirin"               (53w0  88b0 102w0 138b1  85w0 134b1 110w1  92b1)    0   4.0)
(30  "Sveshnikov, Evgeny"           (99b1  67w0  79b0 119w1  83b½  77w1  51b0  73b0)   -2   3.5)
(57  "Prasad, Devaki V."           (127b1  23w0 101b½  81w½  95b½ 119w1  33b0  79w0)    0   3.5)
(59  "Boric, Muhamed"              (129b1  25w½  29b0  95w½ 100b1  19w0  90b½ 119w0)    0   3.5)
(69  "Velikhanli, Firuza"          (138w1  32b0 136w½ 108b½ 118w1  47b0 104w½  96b0)    0   3.5)
(72  "Gureili, Nino"                 (3b0 105w1  19b0  99w1  13b0 101w1  44b0  98w½)    0   3.5)
(74  "Salem, Ghuloom"                (5b0 107w1  27b0 100w0 112w1 102b1  45w½  34b0)    0   3.5)
(75  "Kadimova, Ilaha"               (6w0 108b0 127b½ 113w1  97b0 112w1  95b1  45w0)    0   3.5)
(81  "Roghani, Arash"               (12w0 114b1  35w½  57b½   8w½  32b0  97w1  55b0)    0   3.5)
(82  "Poulsen, Martin"              (13b0 115w1  37b0 103w1  54b½  42w0 119b0 109w1)    0   3.5)
(86  "Hilwani, Talal"               (17b0 117w1  42b0 107w½ 127b0 113b1 109w1  54w0)    0   3.5)
(89  "Jasim, A. R. Saleh"           (20w0 123b1  43w0 116b1  41w0 109b½  54b0 112w1)    0   3.5)
(90  "Ali, Mahmoud"                 (21b0 125w1  50b0 127w½ 109b½ 111w1  59w½  66b0)    0   3.5)
(91  "Janahi, Zeyaad"               (22w0 126b1  47w0 118b0 120w1 136b1  64w0 130b½)    0   3.5)
(98  "Alieva, Elmira"               (29b0 131w1  56b0  41b0 123w1  61w0 107b1  72b½)   -2   3.5)
(13  "Jday, Wassim"                 (45w0  80b½  92w0  75b0 122b1  86w0 132b1  95w1)    0   3.5)
(14  "Chiekh Mhamed, Kamel"         (46b0  81w0 130b0 132b½ 128w1  92b0 125w1 106w1)    0   3.5)
(15  "Alsharhan, F."                (47w0  82b0 128w½ 104b0 125w1 110b1  65w0)  97b1    0   3.5)
(30  "Ahmed, Ishaq"                 (61b0  96b0 114w1  93w0  99b0 116w1 105b1  91w½)    0   3.5)
(70  "Saleh, Nabil"                  (1b0 134b1 137w1  38w0 101b1  29w0  93b0 104b0)   -2   3.0)
(92  "Asylguzhin, Radik"            (23b0 127w½ 113b1  52w0 119b0 114w1  77b½ 121w0)    0   3.0)
(94  "Baum, Bernd Dr."              (25b0 129w1  52b½  63w½  56b0 117w1  61b0  65b0)   -2   3.0)
(99  "Sadatnajafi, M."              (30w0 136b0 120w1  72b0 130w1  65w1  62b0  85b0)    0   3.0)
(00  "Mahmoody, M. Sadegh"          (31b0 133w1  61b0  74b1  59w0  79w0 111b1  76w0)    0   3.0)
(02  "Sorokina, Anastasia"          (33b0 135w0 121b1  83w0 137b1  74w0 117b1  77w0)    0   3.0)
(03  "Mamedjarova, Turkan"          (34w½  51b½  66w0  82b0 134w1  76b0 129w1  88b0)    0   3.0)
(11  "Bashirinia, Omid"             (43w0  78b½  80w0 134b½ 132w1  90b0 100w0 129b1)    0   3.0)
(18  "Al-Housa, Khalil"             (50b0  85w0 133b1  91w1  69b0  93w0  87b0 105w1)    0   3.0)
(22  "Mariano, Cristine Rose"         (r½  65w0  77b0 106b0 113w0 128b1 116w½ 107w1)    1   3.0)
(23  "Saeed, Ishaq"                 (54b0  89w0 105b0 131w1  98b0 137w1 101b1  83w0)    0   3.0)
(27  "Perman, Torvald"              (57w0  92b½  75w½  90b½  86w1  46b0  83b½  87w0)    0   3.0)
(36  "Albers, Andreas"              (67b0  99w1  69b½  65w½  63b0  91w0 106b½ 101w½)    0   3.0)
(95  "Doostkam, P."                 (26w½   8b0 132w1  59b½  57w½  40b0  75w0) 113b0    0   2.5)
(97  "Pourkashiyan, Atousa"         (28w0 132b½ 134w1  64b0  75w1  49b0  81b0 115w0)    0   2.5)
(01  "Shihab, Khaled"               (32w0 138b1  57w½  71b½  70w0  72b0 123w0 136b½)    0   2.5)
(06  "Faisal, Abdulla"              (37b0  73w0 125b½ 122w1  76w½  85b0 136w½ 114b0)    0   2.5)
(09  "Ihsan, Jawad"                 (40w½  34b0  76w0 128b1  90w½  89w½  86b0  82b0)    0   2.5)
(12  "Azimi, Reza"                  (44b0  79w0 129b½ 125w1  74b0  75b0 120w1  89b0)   -2   2.5)
(17  "Almulla, Mohammed A. R."      (49w0  86b0 138w1  88b1  34w0  94b0 102w0 120b½)    0   2.5)
(25  "Yousif, Ammar Mohd."          (55w0  90b0 106w½ 112b0 115b0 131w1 114b0 137w1)    0   2.5)
(26  "Abulhul, Tarik"               (56b0  91w0 107b0 120b0 129w0 138b1 134w½ 110b1)   -2   2.5)
(28  "Khachatourian, Yerazik"       (58b0  93w0 115b½ 109w0 114b0 122w0 131b1 116b1)   -2   2.5)
(32  "Kayle, Charles"               (63b0  97w½  95b0 114w½ 111b0 120b½ 113w0 138b1)   -2   2.5)
(34  "Salem, A. R. Saleh"           (65b½  70w0  97b0 111w½ 103b0 121w0 126b½ 131w1)    0   2.5)
(05  "Saleh, Nagueb"                (36w0  72b0 123w1  85b1  71w0  88b0 130w0 118b0)    0   2.0)
(07  "Nadir, Samir"                 (38w0  74b0 126w1  86b½  78w0 129b½  98w0 122b0)    0   2.0)
(20  "Mouradian, Knarik"            (52b0  87w0  99b0 126w1  91b0 132w½ 112b0 117w½)    0   2.0)
(29  "Zibaei, Abdoulla"             (59w0  94b0 112w½ 110b0 126b1 107w½ 103b0 111w0)    0   2.0)
(10  "Kolyaie, Hasan"               (42b0  76b½  78w0 129w1  77b0 115w0 121b0 126w0)    0   1.5)
(16  "Nekrasova, Elena"             (48b0  83w0 131b1  89w0  88w0 130b0 122b½ 128w0)    0   1.5)
(37  "Mohamed, Eissa"                 (r1  33w0  70b0  96b0 102w0 123b0 138w½ 125b0)   -1   1.5)
(35  "Ghader Pour, Shayesteh"       (66w0 102b1  71w0    r0    r0    r0    r0    r0)    1   1.0)
(38  "Carlsen, Ellen"               (69b0 101w0 117b0 121w0 131b½ 126w0 137b½ 132w0)    0   1.0)
(60  "Khurtsidze, Nino"               (r½    r0    r0    r0    r0    r0    r0    r0)    0   0.5)
(31  "Antonio, Viani D'cunha"       (62w0  98b0 116w0 123b0 138w½ 125b0 128w0 134b0)    0   0.5)
(68  "Weindl, Alfred"                 (r0    r0    r0    r0    r0    r0    r0    r0)    0   0.0)
(84  "Shukurova, Mekihriban"          (r0    r0    r0    r0    r0    r0    r0    r0)    0   0.0)
(24  "Carlsen, Henrik"              (41w0    r0    r0    r0    r0    r0    r0    r0)    1   0.0)
(33  "Hansch, Klaus Michel"         (64w0 100b0 118w0    r0    r0    r0    r0    r0)    1   0.0)))
(setq player (first table))
(setq res (first (results qwe)))

(defun seeding (player) (first player))
;;(seeding qwe)
(defun name (player) (second player))
;;(name qwe)
(defun results (player) 
  (mapcar #'parse-result (third player)))
;;(results qwe)
(defun score (player) (fifth player))
;;(score qwe)
(defun parse-result (result)
  (let ((s (if (symbolp result) (symbol-name result) result)))
    (if (string-match "\\([0-9]+\\)\\([bw]\\)\\([10½]\\)" s)
      (let ((opponent (string-to-number (match-string 1 s)))
	    (color (match-string 2 s))
	    (result (match-string 3 s)))
	(setq result (if (string= result "½") 0.5 (string-to-number result)))
	(list opponent color result)))))
;;(parse-result res)

(defun oppenents (player) (mapcar #'get-player (oppenents-seeding player)))
;;(oppenents player)

(defun oppenents-seeding (player) (mapcar #'first (results player)))
;;(oppenents-seeding player)

(defun opponent-seeding (result) (first result))
;;(opponent (first (results player)))

(defun points (result) (or (third result) 0))
;;(points (first (results player)))

(defun get-player (seeding)
  (find seeding table :key #'first))
;;(get-player 6)

(defun wp (player) (apply #'+ (mapcar #'score (oppenents player))))
;;(wp player)

(defun sb (player) (apply #'+ (mapcar* #'* 
			  (mapcar #'score (oppenents player))
			  (mapcar #'points (results player)))))
;;(mapcar #'sb table)

(defun ps (player) (apply #'+ (mapcar* #'* 
			  (mapcar #'score (oppenents player))
			  (mapcar #'(lambda (result) (if (= (third result) 1) 1 0)) (results player)))))
;;(ps player)